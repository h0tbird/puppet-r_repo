#!/bin/bash

#------------------------------------------------------------------------------
# Produce a valid yum.conf:
#------------------------------------------------------------------------------

sed '/exclude/c\exclude=*.i?86' /etc/yum.conf > /tmp/yum.conf

#------------------------------------------------------------------------------
# Synchronize a remote YUM repository with a local directory:
#------------------------------------------------------------------------------

reposync -c /tmp/yum.conf -r ${1} -d -p ${2} -n

#------------------------------------------------------------------------------
# Create a repomd (xml-rpm-metadata) repository from a set of rpms:
#------------------------------------------------------------------------------

createrepo -c ${2}/${1}/cachedir --update ${2}/${1}

#------------------------------------------------------------------------------
# Create a set of static HTML pages for easy browsing:
#------------------------------------------------------------------------------

repoview -t $1 ${2}/${1}
